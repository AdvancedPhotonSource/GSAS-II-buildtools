# new GitHub Action to test use of outputs

name: test action

permissions:
  contents: write
  
on: [workflow_dispatch]

outputs:
  tar-file:
    description: "tar file generated by script"
    value: ${{ steps.test-compile-step.tar-name }}

jobs:
  runs:
    using: "composite"

    runs-on: ${{ matrix.os }}
    strategy:
      fail-fast: false
      matrix:
#      os: [ubuntu-latest, windows-latest, macos-13, macos-14]
        os: [macos-14]
#      os: [windows-latest]
#      os: [macos-13]

    steps:
      - uses: fortran-lang/setup-fortran@v1
        id: setup-fortran
        with:
          compiler: gcc
          version: 13

      - name: Test save output
        id: test-compile-step
        shell: bash -l {0}
        run: |
           echo $RUNNER_OS
           newdir=test-1234.tgz
           echo "tar-name=$(echo ${TMPFILE}${newdir})" >> $GITHUB_OUTPUT

      - name: Read output
        run: echo "${{ steps.test-compile-step.tar-name }}"
